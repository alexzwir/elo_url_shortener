<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Encurtador Elo</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/static/style.css">
</head>
<body class=bd-light>
    <div class="container">
        <div class="py-5 text-center">
            <img class="d-block mx-auto mb-4" src="/static/logo.svg" alt="" width="72" height="72">
            <h1>URL Builder</h1>
            <p class="lead">Ferramenta para geração de links trackeados (com UTM's) para Google Analytics e encurtador via Bit.ly. Siga o passo a passo abaixo:</p>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-10 mb-3">
                    <h3>Escolha a página que você deseja fazer a ação:</h3>
                    <div class="custom-control custom-radio">
                        <input id="site-use-elo" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://use.elo.com.br/">
                        <label class="custom-control-label" for="site-use-elo">Site Use Elo</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="site-use-elo-bradesco" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://use.elo.com.br/bradesco/">
                        <label class="custom-control-label" for="site-use-elo-bradesco">Site Use Elo - Bradesco</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="site-use-elo-banco-do-brasil" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://use.elo.com.br/banco-do-brasil/">
                        <label class="custom-control-label" for="site-use-elo-banco-do-brasil">Site Use Elo - Banco do Brasil</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="site-use-elo-caixa" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://use.elo.com.br/caixa/">
                        <label class="custom-control-label" for="site-use-elo-caixa">Site Use Elo - Caixa</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="site-use-elo-pernambucanas" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://use.elo.com.br/pernambucanas/">
                        <label class="custom-control-label" for="site-use-elo-pernambucanas">Site Use Elo - Pernambucanas</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="site-elo" name="url-inicial" type="radio" class="custom-control-input" required="" value="https://elo.com.br/">
                        <label class="custom-control-label" for="site-elo">Site Elo</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-10 mb-3">
                    <h3>Por quem será divulgada essa ação?</h3>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-bradesco" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=EmissorBradesco">
                        <label class="custom-control-label" for="utm-source-bradesco">Bradesco</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-banco-do-brasil" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=EmissorBancodoBrasil">
                        <label class="custom-control-label" for="utm-source-banco-do-brasil">Banco do Brasil</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-caixa" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=EmissorCaixa">
                        <label class="custom-control-label" for="utm-source-caixa">Caixa</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-pernambucanas" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=EmissorPernambucanas">
                        <label class="custom-control-label" for="utm-source-pernambucanas">Pernambucanas</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-google" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=Google">
                        <label class="custom-control-label" for="utm-source-google">Google</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-facebook" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=Facebook">
                        <label class="custom-control-label" for="utm-source-facebook">Facebook</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-sms" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=SMS">
                        <label class="custom-control-label" for="utm-source-sms">SMS</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-emailmarketing" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=EmailMarketing">
                        <label class="custom-control-label" for="utm-source-emailmarketing">Email Marketing</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input id="utm-source-smartmessage" name="utm-source" type="radio" class="custom-control-input" required="" value="?utm_source=SmartMessage">
                        <label class="custom-control-label" for="utm-source-smartmessage">Smart Message</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-10 mb-3">
                    <h3>Qual formato que será usado?</h3>
                    <label for="utm-medium">Ex: Display, Internet Banking, Intranet.... <span class="text-muted">(Lembre-se de escrever o texto todo junto e em letras minúsculas)</span></label>
                    <input type="text" class="form-control" id="utm-medium" placeholder="Ex: internetbanking, display, intranet, ...." name="utm-medium">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-10 mb-3">
                    <hr class="mb-4">    
                </div>
            </div>
        </div>
        <div class="row  mb-3">   
            <div class="col-md-6">
                <button class="btn btn-primary btn-lg btn-block" id="gerar-url" type="submit">Gerar URL</button>
            </div>
        </div>
        <div class="row"> 
            <div class="col-md-10  mb-3">
                <div id="url-final-div" class="alert alert-dark mb-3">
                    <p>A URL final é: <a class="alert-link" id="url-final"></a></p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-10 mb-3">
                    <hr class="mb-4">    
                </div>
            </div>
        </div>
        <div class="row"> 
            <div class="col-md-10  mb-3">
                <div id="url-shorten-form" class="mb-3">
                    <form id="elo_url_shortener_form" class="mb-3" action="/elo_url_shortener" method="POST" data-url="/elo_url_shortener" >{% csrf_token %}
                        <h4>Deseja encurtar a URL? Clique abaixo:</h4>
                        <div class="input-group">
                            {{ form_elo_url_to_be_shorten.elo_url_to_be_shorten }}
                            <div class="input-group-append">
                                <button type="submit" id="shorten-button" class="btn btn-secondary">Encurtar URL</button>
                            </div>
                        </div>

                    </form>
                </div>
                <div id="final-elo-shorten-url" class="alert alert-dark" role="alert">
                    <p>A url encurtada é: <a id="final-elo-shorten-url-span" class="alert-link"></a></p>
                    <p><strong>Lembre-se de testar a URL antes de enviar para o parceiro.</strong></p>
                </div>
            </div>
        </div>
    </div>
    
    


    <script>
        $(document).ready(function(){

            $("#url-final-div").hide();
            $("#url-shorten-form").hide();
            $("#final-elo-shorten-url").hide();

            $("#gerar-url").click(function() {
                $("#url-final-div").show();
                $("#url-shorten-form").show();

                var url_inicial = $("input[name='url-inicial']:checked").val();
                var utm_source = $("input[name='utm-source']:checked").val();
                var utm_medium_raw = $("#utm-medium").val();
                var utm_medium = "&utm_medium="+ utm_medium_raw;
                var url_parcial = url_inicial+utm_source+utm_medium;
                
                $("#url-final").text(url_parcial);
                $("#url_parcial_input").val(url_parcial);

            });

            $("#shorten-button").click(function() {
                var $myForm = $("#elo_url_shortener_form");
                $($myForm).submit(function(event){
                    event.preventDefault();
                    var $formData = $(this).serialize();
                    var $thisURL = $myForm.attr('data-url') || window.location.href;
                    // console.log($formData);
                    // console.log($thisURL);
                    $.ajax({
                        method:"POST",
                        url: $thisURL , 
                        data:$formData,
                        success: handleFormSuccess,
                        error:handleFormError
                    });
                });
            });

            function handleFormSuccess(data, textStatus, jqXHR){
                $('#final-elo-shorten-url').show()
                $('#final-elo-shorten-url-span').text(data)
                // console.log(data);
                // console.log(textStatus);
                // console.log(jqXHR);
                //$(".appointment-form-fields").hide();
                //$("#appointment_form").attr("style","height:513px");
                //$(".success-message").fadeIn();
                //$myForm[0].reset(); // reset form data
            }

            function handleFormError(jqXHR, textStatus, errorThrown){
                console.log(jqXHR);
                console.log(textStatus);
                console.log(errorThrown);
            }

        });
                    
    </script>



</body>
</html>